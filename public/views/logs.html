<div x-data="logsViewer" class="w-full h-full flex flex-col bg-black text-xs font-mono">

    <!-- Toolbar -->
    <div
        class="h-10 flex items-center justify-between px-4 border-b border-space-800 bg-space-950/50 backdrop-blur shrink-0 gap-4">

        <!-- Search -->
        <div class="relative flex-1 max-w-md group">
            <div class="absolute inset-y-0 left-0 pl-2 flex items-center pointer-events-none">
                <svg class="h-3.5 w-3.5 text-gray-600 group-focus-within:text-gray-400 transition-colors" fill="none"
                    viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                        d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" />
                </svg>
            </div>
            <input type="text" x-model="searchQuery" :placeholder="$store.global.t('grepLogs')"
                class="w-full h-7 bg-transparent border-none text-gray-300 placeholder-gray-700 focus:ring-0 focus:outline-none pl-8 text-xs font-mono">
        </div>

        <!-- Filters -->
        <div class="flex items-center gap-3 border-l border-space-800 pl-4 h-6">
            <template x-for="level in ['INFO', 'WARN', 'ERROR', 'SUCCESS', 'DEBUG']">
                <button @click="filters[level] = !filters[level]"
                    x-show="level !== 'DEBUG' || $store.settings.debugLogging"
                    class="flex items-center gap-1.5 px-1.5 py-0.5 rounded transition-all duration-200" :class="{
                        'opacity-50 hover:opacity-100': !filters[level],
                        'bg-blue-500/10 text-blue-400': level === 'INFO' && filters[level],
                        'bg-yellow-500/10 text-yellow-400': level === 'WARN' && filters[level],
                        'bg-red-500/10 text-red-500': level === 'ERROR' && filters[level],
                        'bg-green-500/10 text-green-400': level === 'SUCCESS' && filters[level],
                        'bg-purple-500/10 text-purple-400': level === 'DEBUG' && filters[level]
                    }">
                    <div class="w-1.5 h-1.5 rounded-full" :class="{
                            'bg-blue-500': level === 'INFO',
                            'bg-yellow-500': level === 'WARN',
                            'bg-red-500': level === 'ERROR',
                            'bg-green-500': level === 'SUCCESS',
                            'bg-purple-500': level === 'DEBUG'
                        }"></div>
                    <span x-text="level" class="uppercase font-semibold tracking-wide text-[10px]"></span>
                </button>
            </template>
        </div>

        <!-- Actions -->
        <div class="flex items-center gap-2 border-l border-space-800 pl-4 h-6">
            <button @click="isAutoScroll = !isAutoScroll"
                class="flex items-center gap-1.5 text-gray-500 hover:text-white transition-colors"
                :class="{'text-primary': isAutoScroll}">
                <svg class="w-3.5 h-3.5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                        d="M19 14l-7 7m0 0l-7-7m7 7V3" />
                </svg>
            </button>
            <button @click="clearLogs" class="text-gray-500 hover:text-white transition-colors" title="Clear">
                <svg class="w-3.5 h-3.5" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <circle cx="12" cy="12" r="10"></circle>
                    <line x1="15" y1="9" x2="9" y2="15"></line>
                </svg>
            </button>
        </div>
    </div>

    <!-- Logs Content -->
    <div id="logs-container" class="flex-1 overflow-auto bg-black p-2 font-mono text-[11px] leading-5 custom-scrollbar">
        <template x-for="(log, idx) in filteredLogs" :key="idx">
            <div
                class="flex items-start gap-3 px-2 py-0.5 hover:bg-space-900/50 rounded-sm group transition-colors select-text">

                <!-- Status Dot -->
                <div class="pt-1.5 shrink-0">
                    <div class="w-2 h-2 rounded-full" :class="{
                            'bg-blue-500 shadow-[0_0_6px_rgba(59,130,246,0.4)]': log.level === 'INFO',
                            'bg-yellow-500 shadow-[0_0_6px_rgba(234,179,8,0.4)]': log.level === 'WARN',
                            'bg-red-500 shadow-[0_0_6px_rgba(239,68,68,0.4)]': log.level === 'ERROR',
                            'bg-green-500 shadow-[0_0_6px_rgba(34,197,94,0.4)]': log.level === 'SUCCESS',
                            'bg-purple-500': log.level === 'DEBUG'
                         }"></div>
                </div>

                <!-- Timestamp -->
                <span class="text-gray-600 shrink-0 tabular-nums w-[72px]"
                    x-text="new Date(log.timestamp).toLocaleTimeString([], {hour12:false, hour:'2-digit', minute:'2-digit', second:'2-digit'})"></span>

                <!-- Message -->
                <span class="text-gray-300 break-all group-hover:text-gray-100 transition-colors"
                    x-html="Redact.logMessage(log.message)"></span>
            </div>
        </template>

        <!-- Empty State -->
        <template x-if="filteredLogs.length === 0">
            <div class="h-full flex flex-col items-center justify-center text-space-800 select-none">
                <span class="text-4xl font-bold opacity-10">LOGS</span>
                <span class="text-xs mt-2 opacity-30 px-4 py-1 border border-space-800 rounded-full">No events
                    yet</span>
            </div>
        </template>
    </div>
</div>